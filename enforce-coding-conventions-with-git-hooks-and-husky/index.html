<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="UTF-8">
  <meta name=viewport content="width=device-width, initial-scale=1">
  <meta name=â€robotsâ€ content="index, follow">
  <!-- Meta -->
  
  <title>Enforce coding conventions with Git Hooks and Husky | Borche.dev</title>
  <meta name="description" content="Examples of how to format code, run tests, and automate the rest of the coding conventions checks.">
  <meta property="og:title" content="Enforce coding conventions with Git Hooks and Husky" />
  <meta property="og:url" content="https://borche.dev/enforce-coding-conventions-with-git-hooks-and-husky/" />
  <meta property="og:image" content="https://borche.dev/files/images/featured/git.jpg" />
  <meta property="og:type" content="article" />
  <meta property="og:description" content="Examples of how to format code, run tests, and automate the rest of the coding conventions checks." />

  <!-- CSS -->
  <link type="text/css"  href="/css/neumorphism.css" rel="stylesheet" />
  <link type="text/css" href="/css/style.css" rel="stylesheet" />
  <link
    type="text/css"
    href="/vendor/@fortawesome/fontawesome-free/css/all.min.css"
    rel="stylesheet"
  />
  <link
  type="text/css"
  href="/vendor/prismjs/themes/prism-synthwave84.css"
  rel="stylesheet"
/>
<link
type="text/css"
href="/vendor/prismjs/plugins/match-braces/prism-match-braces.css"
rel="stylesheet"
/>
  <!-- Favicon -->
  <link rel="icon" type="image/png" href="/favicon.png"/>

</head>

  <body class="match-braces">
    <header class="header-global">
      <nav
        id="navbar-main"
        aria-label="Primary navigation"
        class="navbar navbar-main navbar-expand-lg navbar-theme-primary headroom navbar-light"
      >
        <div class="container position-relative">
          <a href="/">
            <h1 class="logo">Borche.dev</h1>
          </a>
        </div>
      </nav>
    </header>
    <main><section class="section-header pb-0 bg-primary">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10 text-center">
                <h1 class="display-3 mb-4 px-lg-5">Enforce coding conventions with Git Hooks and Husky</h1>
                <div class="post-meta">
                    <span class="post-date">December 12, 2022</span>
                </div>
            </div>
        </div>
    </div>
</section>

<div class="section section-sm bg-primary text-black">
    <article class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-8 shadow-soft p-4 border border-light rounded post-content text-break">
                <p>Coding conventions are rules set in place to help us maintain a level of readability and consistency in the codebase.<br>These rules may involve programming style, architectural best practices, non-functional requirements, etc.<br>Git hooks are scripts that run before or after <a target="_blank" rel="noopener" href="https://git-scm.com/docs/githooks#_hooks">git events</a> such as commit, push, checkout, etc. If any of these scripts reports an error, the git action will fail.<br>Husky is a popular JavaScript package for working with git hooks.<br>To add husky to your project, install the dependency and run the <a target="_blank" rel="noopener" href="https://typicode.github.io/husky/#/?id=automatic-recommended">init command</a>:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ npx husky-init &amp;&amp; npm install</code></pre>
<p>The syntax for updating or adding hooks is <code>husky add &lt;file&gt; [command]</code>.<br>For example, the following command creates a hook that prints <strong>hello from husky pre-commit hook</strong> in the console before each commit.</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ npx husky add .husky&#x2F;pre-commit &quot;echo \&quot;hello from husky pre-commit hook \&quot;&quot;</code></pre>
<p>We can test it by running:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ git commit --allow-empty -m &quot;Testing husky...&quot;</code></pre>
<p>With the Hello World illustration out of the way, we can move into more practical examples.</p>
<h2 id="Prettify-code-with-Lint-staged-and-Biome"><a href="#Prettify-code-with-Lint-staged-and-Biome" class="headerlink" title="Prettify code with Lint-staged and Biome"></a>Prettify code with Lint-staged and Biome</h2><p>A standardized set of formatting rules will help us avoid unnecessary conflicts that might appear in git diffs.<br>For this, we can use <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/lint-staged">lint-staged</a>, a library for running scripts against a set of staged git files, and <a target="_blank" rel="noopener" href="https://biomejs.dev/">Biome</a> as a formatter.<br>Start by installing the dependencies:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ npm install --save-dev lint-staged @biomejs&#x2F;biome</code></pre>
<p>Add the lint-staged script and configuration to the package.json file. In my example, I will format only .js, .ts, .jsx, and .tsx files.</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">&#123;
  &quot;name&quot;: &quot;Playground&quot;,
  &quot;version&quot;: &quot;1.0.0&quot;,
  &quot;scripts&quot;: &#123;
    &quot;prepare&quot;: &quot;husky install&quot;,
    &quot;prettify-staged&quot;: &quot;lint-staged&quot;
  &#125;,
  &quot;lint-staged&quot;: &#123;
    &quot;*.&#123;js,ts,tsx,jsx&#125;&quot;: [
      &quot;biome format --write&quot;
    ]
  &#125;,
  &quot;devDependencies&quot;: &#123;
    &quot;husky&quot;: &quot;^8.0.0&quot;,
    &quot;lint-staged&quot;: &quot;^15.2.0&quot;,
    &quot;@biomejs&#x2F;biome&quot;: &quot;^1.4.1&quot;
  &#125;
&#125;
</code></pre>
<p>Donâ€™t forget to update the pre-commit hook!</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ npx husky add .husky&#x2F;pre-commit &quot;npm run prettify-staged&quot;</code></pre>
<p>Thatâ€™s it! ðŸ¥³ From now on, on every commit, the staged JavaScript &amp; TypeScript files will be formatted by Rome.</p>
<h2 id="Lint-code-and-run-tests-before-pushing-to-remote"><a href="#Lint-code-and-run-tests-before-pushing-to-remote" class="headerlink" title="Lint code and run tests before pushing to remote"></a>Lint code and run tests before pushing to remote</h2><p>Start by adding a lint task into package.json:</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">&quot;scripts&quot;: &#123;
  &quot;lint&quot;: &quot;biome lint .&#x2F;&quot;
&#125;</code></pre>
<p>and update the pre-push task by running:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ npx husky add .husky&#x2F;pre-push &quot;npm run lint&quot;
$ npx husky add .husky&#x2F;pre-push &quot;npm run test&quot;</code></pre>
<p>From now on, on every push, the codebase should satisfy the linter requirements, and tests should pass.</p>
<h2 id="Bypassing-hooks"><a href="#Bypassing-hooks" class="headerlink" title="Bypassing hooks"></a>Bypassing hooks</h2><p>While these hooks are helpful in our everyday lives, itâ€™s easy to imagine a scenario where avoiding these hooks is beneficial. To skip the execution of a git hook, append <code>--no-verify</code> at the end of the command.<br>For example:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ git push --no-verify</code></pre>
<p>command will skip the execution of our pre-push checks.</p>
<h2 id="Next-steps"><a href="#Next-steps" class="headerlink" title="Next steps"></a>Next steps</h2><p>If your project doesnâ€™t have git hooks, now is the perfect time to introduce them and gain extra points in the upcoming performance reviews.<br>The alternative is to go crazy, think big, and share your new hook with the development community. Look at projects like <a target="_blank" rel="noopener" href="https://lolcommits.github.io/">lolcommits</a>, <a target="_blank" rel="noopener" href="https://github.com/sparkbox/commit-colors">commit-colors</a> and <a target="_blank" rel="noopener" href="https://github.com/bmwant/podmena">podmena</a> for inspiration.</p>

            </div>
        </article>
    </div>
</main>
    <footer class="d-flex pb-5 pt-5 pt-md-5 border-top border-light bg-primary">
  <div class="container">
    <div class="row">
      <div class="col-9">
        <ul class="d-flex list-unstyled mb-5 mb-lg-0">
          <li class="mr-2">
            <a
              rel="noopener"
              href="https://github.com/DeepSpaceHarbor"
              target="_blank"
              class="btn btn-icon-only btn-pill btn-primary"
              aria-label="github social link"
              data-toggle="tooltip"
              data-placement="top"
              title="Open source projects"
            >
              <span aria-hidden="true" class="fab fa-github"></span>
            </a>
          </li>
          <li>
            <a
              href="mailto:hello@borche.dev"
              target="_blank"
              class="btn btn-icon-only btn-pill btn-primary"
              aria-label="email address link"
              data-toggle="tooltip"
              data-placement="top"
              title="Say ðŸ‘‹ at hello@borche.dev"
            >
              <span aria-hidden="true" class="fas fa-paper-plane"></span>
            </a>
          </li>
        </ul>
      </div>
      <div class="col-3">
        <button
          aria-labelledby="scroll to top"
          class="btn btn-primary animate-up-2"
          type="button"
          onclick="scrollToTop()"
        >
        <span class="back-to-top-text">
          Back to top
        </span>
          <span class="ml-1">
            <i class="fas fa-angle-double-up"></i>
          </span>
        </button>
      </div>
    </div>
  </div>
</footer>
 <!-- Core -->
<script src="/vendor/jquery/jquery-3.5.1.min.js"></script>
<script src="/vendor/popper.js/dist/umd/popper.min.js"></script>
<script src="/vendor/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/vendor/headroom.js/dist/headroom.min.js"></script>
<!-- Vendor JS -->
<script src="/vendor/onscreen/dist/on-screen.umd.min.js"></script>
<script src="/vendor/nouislider/distribute/nouislider.min.js"></script>
<script src="/vendor/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js"></script>
<script src="/vendor/waypoints/lib/jquery.waypoints.min.js"></script>
<script src="/vendor/jarallax/dist/jarallax.min.js"></script>
<script src="/vendor/jquery.counterup/jquery.counterup.min.js"></script>
<script src="/vendor/jquery-countdown/dist/jquery.countdown.min.js"></script>
<script src="/vendor/smooth-scroll/dist/smooth-scroll.polyfills.min.js"></script>
<script src="/vendor/prismjs/prism.js"></script>
<script src="/vendor/prismjs/plugins/autoloader/prism-autoloader.min.js"></script>
<script src="/vendor/prismjs/plugins/match-braces/prism-match-braces.min.js"></script>
<!-- Neumorphism JS -->
<script src="/js/neumorphism.js"></script>

<script>
  function scrollToTop() {
    $(window).scrollTop(0);
  }
</script>


  </body>
</html>
